#!/usr/bin/env ruby

require 'optparse'
require 'methadone'
require 'cg/deploy/all.rb'

class App
  include Methadone::Main
  include Methadone::CLILogging

  main do 
   Cg::Deploy::All::CLI.run(options)
  end

  on("-u user", "--username", "username for the docker image. passes directly to cg")
  on("-t tag", "--tag", "tag for the docker image. defaults to the git commit id of the build context. slashes are replaced with periods. passes directly to cg")
  on("--serial", "run deploy commands serially. defaults to parallel")
  on("-e envs", "--environments", "environment(s) to deploy to. accepts * wildcards and comma-separated values")

  version Cg::Deploy::All::VERSION

  description "Deploy a Cloudgate app to multiple envs at once"

  go!
end
